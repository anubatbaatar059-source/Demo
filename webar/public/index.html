<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
  <title>WebAR ‚Äî Intro ‚Üí –ú–µ–Ω—é ‚Üí –î–∞—Å–≥–∞–ª</title>

  <!-- Main styles -->
  <link rel="stylesheet" href="./styles/main.css">

  <!-- Service Worker cache —É–Ω—Ç—Ä–∞–∞—Ö -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations?.().then(rs => rs.forEach(r => r.unregister()));
    }
  </script>

  <!-- Vendor (UMD) -->
  <script src="https://unpkg.com/three@0.152.2/build/three.min.js" defer></script>
  <script src="https://unpkg.com/@zappar/zappar-threejs@2.5.2/umd/zappar-threejs.js" defer></script>

  <!-- Vendor –±—ç–ª—ç–Ω –±–æ–ª–º–æ–≥—Ü Promise-–∞–∞—Ä –∞–≤–∞—Ö -->
  <script>
    window.__depsReady = new Promise(res => addEventListener('load', () => {
      res({ THREE: window.THREE, ZapparThree: window.ZapparThree });
    }, { once:true }));
  </script>
</head>
<body>
  <div id="debug">DEBUG: boot‚Ä¶</div>

  <!-- Tap-to-start -->
  <div id="tapToStart"><button class="btn">‚ñ∂ –≠—Ö–ª“Ø“Ø–ª—ç—Ö (–¥—É—É –Ω—ç—ç—Ö)</button></div>
  <button id="btnUnmute" class="btn">üîä –î—É—É–≥ –∞—Å–∞–∞—Ö</button>

  <!-- Intro buttons -->
  <div id="overlayIntroBtns">
    <div id="ibExercise" class="introbtn">üèÉ –î–ê–°–ì–ê–õ</div>
    <div id="ibGrowth" class="introbtn">üå± –•”®–ì–ñ–ò–õ</div>
    <div id="ibKnowledge" class="introbtn">üìò –•–ò–ß–≠–≠–õ</div>
  </div>

  <!-- –ú–µ–Ω—é -->
  <div id="menu">
    <div class="menu-panel">
      <h2 class="menu-title">AR –ú–µ–Ω—é</h2>
      <p class="menu-sub">–¢—É—Ä—à–ª–∞–≥–∞–∞ —Å–æ–Ω–≥–æ–Ω–æ —É—É</p>
      <div class="menu-grid">
        <div class="card" id="mExercise">
          <div class="icon">üèÉ</div>
          <div>
            <div class="ttl">–î–∞—Å–≥–∞–ª</div>
            <div style="opacity:.8;font-size:12px">–®—É—É–¥ —Ç–æ–≥–ª—É—É–ª–∞—Ö</div>
          </div>
        </div>
        <div class="card" id="mGrowth">
          <div class="icon">üå±</div>
          <div>
            <div class="ttl">–•—É–≤—å —Ö“Ø–Ω–∏–π —Ö”©–≥–∂–∏–ª</div>
            <div style="opacity:.8;font-size:12px">–¢—É–Ω —É–¥–∞—Ö–≥“Ø–π</div>
          </div>
        </div>
        <div class="card" id="mKnowledge">
          <div class="icon">üìò</div>
          <div>
            <div class="ttl">–•–∏—á—ç—ç–ª</div>
            <div style="opacity:.8;font-size:12px">–¢—É–Ω —É–¥–∞—Ö–≥“Ø–π</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- OTP Gate (v2 minimal) -->
  <div id="otpGate" hidden>
    <div class="otpv2">
      <div class="otp-head">
        <div class="otp-icon">üì±</div>
        <div class="otp-title-wrap">
          <h3 class="otp-title">–£—Ç–∞—Å –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö</h3>
          <p class="otp-sub">–î–∞—Ä–∞–∞ –Ω—å 6 –æ—Ä–æ–Ω—Ç–æ–π –∫–æ–¥ SMS-—ç—ç—Ä –∏—Ä–Ω—ç.</p>
        </div>
      </div>

      <!-- –ê–ª—Ö–∞–º A: –£—Ç–∞—Å –æ—Ä—É—É–ª–∞—Ö -->
      <div id="stepPhone" class="step shown">
        <label class="field">
          <span class="prefix">+976</span>
          <input id="otpPhone" type="tel" inputmode="numeric" autocomplete="tel"
                 placeholder="–£—Ç–∞—Å–Ω—ã –¥—É–≥–∞–∞—Ä (8 —Ü–∏—Ñ—Ä)" maxlength="8">
        </label>
        <button id="btnNext" class="btn full">–ö–æ–¥ –∞–≤–∞—Ö</button>
      </div>

      <!-- –ê–ª—Ö–∞–º B: –ö–æ–¥ –æ—Ä—É—É–ª–∞—Ö -->
      <div id="stepCode" class="step">
        <div class="otp-to">
          <div class="otp-icon small">üîê</div>
          <div class="to-text">
            <div class="mini">–ö–æ–¥ –∏–ª–≥—ç—ç–≥–¥—Å—ç–Ω –¥—É–≥–∞–∞—Ä</div>
            <div class="phone" id="otpToPhone">+976 ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
          </div>
          <button id="btnBack" class="ghost sm">–ó–∞—Å–∞—Ö</button>
        </div>

        <div id="otpInputs" class="code-grid"></div>

        <button id="btnVerify" class="btn full">–ë–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö</button>

        <div class="row-center">
          <span class="chip" id="cooldownChip"><span id="otpTimer">60</span> —Å–µ–∫</span>
          <button id="btnResend" class="ghost" disabled>–î–∞—Ö–∏–Ω –∏–ª–≥—ç—ç—Ö</button>
        </div>
      </div>

      <div id="otpError" class="otp-error"></div>

      <div class="devtools">
        <span class="hint">–¢—É—Ä—à–∏–ª—Ç—ã–Ω –∫–æ–¥: <b>000000</b></span>
        <button id="btnOtpReset" class="ghost sm">–î–∞—Ö–∏–Ω —Ç—É—Ä—à–∏—Ö</button>
      </div>
    </div>
  </div>

  <!-- Hidden videos -->
  <video id="vidIntro" playsinline preload="auto" crossorigin="anonymous" hidden></video>
  <video id="vidExercise" playsinline preload="auto" loop crossorigin="anonymous" hidden></video>

  <!-- –¢–∞–Ω–∞–π –º–æ–¥—É–ª–∏—É–¥ -->
  <script type="module" src="./src/app.js"></script>
</body>
</html>
